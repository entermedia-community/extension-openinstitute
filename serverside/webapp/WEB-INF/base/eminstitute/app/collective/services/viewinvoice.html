#set( $currency = '$' )
#set( $id = $context.getRequestParameter('invoiceid')) 
#set( $invoice =	$mediaarchive.getInvoiceById($id)) 
#set( $products = $mediaarchive.getInvoiceProductList($id))
#set( $collection = $mediaarchive.query("librarycollection").exact("id",$invoice.getValue("collectionid")).searchOne() )

<div style="width:100%; max-width:980px; margin: 0 auto;">
<div class="card"
	style="margin: 40px; max-width: 100%; text-align: left;">
	<div class="card-body">
		<div class="row">
			<div class="col-sm-5">
				<a href="https://entermediadb.org" target="_blank">
					<img src="$applink/theme/images/invoice-logo.jpg" class="img-fluid">
				</a>
			</div>
			<div class="col-sm-7 text-right">
				EnterMedia, Inc. 1550<br>
				Magnolia Dr. Cincinnati<br>
				OH 45215
			</div>
		</div>
	</div>
	<div class="card-body">
		<div class="row" style="background-color:#efefef; padding:10px 0;">
			<div class="col-sm-6">
					<strong>Invoice Number: $invoice.getValue("invoicenumber")</strong>
					<br>
					Created on: $!context.getDate($invoice.getValue("createdon"))
			</div>
			
		</div>
		<div class="row" style="margin-top:10px;">
			<div class="col-sm-6">
			<strong>Invoiced to:</strong>
				#set($invoicedto =$collection.getValue("invoicedto"))
				#if($invoicedto)
					<div style="line-height: 1;">$invoicedto</div>
				#else
					<br>$!collection
				#end
			</div>
		</div>
	</div>
	
	<div class="card-body" style="padding: 20px;">		
		<h4>Products</h4>
		<div class="table-responsive">
			<table class="d-print-table table">
				<col span="1" style="width: 10%;">
		       	<col span="1" style="width: 70%;">
		       	<col span="1" style="width: 20%;">
				<tr>
					<th class="purchase_heading" align="left">
						<p class="f-fallback">Quantity</p>
					</th>
					<th class="purchase_heading" align="left">
						<p class="f-fallback">Description</p>
					</th>
					<th class="purchase_heading" align="right" style="text-align: right">
						<p class="f-fallback">Amount</p>
					</th>
				</tr>
				#foreach ($product in $products)
				#set ( $prod = $mediaarchive.getProductById($product.productid) )
				<tr>
					<td valign="top" style="vertical-align: top;">$product.productquantity</td>
					
					<td valign="top" style="vertical-align: top;">
						<div>$mediaarchive.getProductName($product.productid)</div>
						<div style="font-size: 0.9em;">$!mediaarchive.text($prod.getValue("productdescription"), $invoice.id)</div>
					</td>
					<td  valign="top" style="text-align: right; vertical-align: top;"><span>$currency $!context.doubleToMoney($product.productprice, 2)</span></td>
				</tr>
				#end
				<tr>
					<td class="text-right" colspan="3"><b>Total (USD)</b></td>
					<td  style="text-align: right"><b>$currency $!context.doubleToMoney($invoice.getValue("totalprice"), 2)</b></td>
				</tr>
			</table>
		</div>
	</div>
</div>
</div>