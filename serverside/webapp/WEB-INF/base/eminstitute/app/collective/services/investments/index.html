#set($collectionid = $librarycol.getId())

#ifnull( $collectionid )
	#set($collectionid = $context.getRequestParameter("collectionid"))
#end

<div style="padding:10px 20px;">
            
            #if( $caneditcollection )    
           <a
                      href="$applink/collective/services/investments/addnew.html?collectionid=${collectionid}"
                      class="emdialog btn btn-sm btn-primary mb-4">[[Add Investment Or Disbursement]]</a>
              #end
		<A href="#" onclick="$('#searchform').toggle()"><i class="fa fa-search"></i></A>

	<form  id="colsearchform" class="autosubmit" data-targetdiv="expensereport" method="post" action="$home$applink/collective/services/investments/results.html">
	
		#set( $searcher = $mediaarchive.getSearcher("collectiveinvestment") )
		$context.putPageValue("searcher",$searcher)
		#set ($details = $searcher.getDetailsForView("collectiveinvestment/search", $userprofile))
	
		<input type="hidden" name="searchtype" value="collectiveinvestment" />
		
		<input type="hidden" name="field" value="collectionid" />
		<input type="hidden" name="collectionid.value" value="$librarycol.id" />
		<input type="hidden" name="operation" value="exact" />
		<input type="hidden" name="oemaxlevel" value="1" />
		
		<table>
		<tr>
		<td width="100%">
		<div  id="searchform" class="row inlinesearch" style="display:none" >
		$context.putPageValue("autocomplete","off")
			#foreach( $detail in $details)
			<div class="col-md-3">
					$context.putPageValue("detail", $detail)
					$pages.include("/${applicationid}/components/advancedsearch/detaileditinline.html", $context)
			</div>
			#if( $counter == 4)
				</div>
				<div  class="row" >
			#end	
			#end
		</div>	
		</td>
		</tr>
		</table>

		<div style="height:30px;width:100%">
		<div style="float:right">
		[[Sort by]]
		<select class="select2" name="sortby" >
			#set ($details = $searcher.getDetailsForView("collectiveinvestment/edit", $userprofile))
		#foreach( $detail in $details)
			<option value="$detail.getId()Down">$context.getText($detail)</option>
			<option value="$detail.getId()Up">$context.getText($detail) [[Reverse]]</option>
		#end
		</select>
		</div>
		</div>

	</form>
	#ifnull( $investments)
              #set( $investments = $mediaarchive.query("collectiveinvestment").exact("collectionid",$collectionid).sort("dateDown").search($context))
              $context.putPageValue("investments",$investments)
	#end
	$pages.include("./results.html",$context)
</div>

