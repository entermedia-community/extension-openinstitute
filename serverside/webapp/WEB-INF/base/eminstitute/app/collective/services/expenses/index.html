#set($collectionid = $librarycol.getId())
#set( $catalagDB = $mediaarchive.query("catalogsettings").exact("id", "events_billing_notify_invoice_appid").searchOne() ) 
#set( $db = "entermediadb" ) 
#if ( $catalagDB )
#set( $db = "$catalagDB.value" ) 
#end

<div style="padding:10px 20px;">
              #if( $canviewsettings )
              	#if($mediaarchive.getCatalogSettingValue("productionmode") == "false")
<div class="alert alert-warning"><b>Site is in TEST mode. Add your keys to catalog settings and switch to production mode to take credit cards.</b></div>
#end
                  
                                                   <a
                      href="$applink/collective/services/expenses/addnew.html?collectionid=${collectionid}"
                      class="emdialog btn btn-sm btn-primary mb-4">[[Add Expenses]]</a>
              #end

              #set( $expenses = $mediaarchive.query("collectiveexpense").match("collectionid",$collectionid).sort("date").search())
              #if ($expenses)
                  <h3>[[Expenses]]</h3>
                  <div class="emdata">
                      <table class="table table-striped">
                          <thead>
                              <tr class="tableheader">
                                  <th>[[Date]]</th>
                                  <th>[[Type]]</th>
                                  <th>[[Description]]</th>
                                  <th>[[Currency]]</th>
                                  <th>[[Total]]</th>
                                  
                                  <th></th>
                              </tr>
                          </thead>
                          #foreach($hit in $expenses)
                              <tr>
                                  <td>$!context.getDate($hit.date)</td>
                                  <td>$!mediaarchive.getData("expensetype", $hit.expensetype)</td>
                                  <td>$!mediaarchive.text($hit.expensedescription, $hit.id)</td>
                                  <td>$!mediaarchive.getData("currencytype", $hit.currencytype)</td>
                                  <td style="text-align: center;">$ $!context.roundDouble($!hit.total, 2)</td>
                        <td style="text-align: center">
                            #if( $canviewsettings )
                                <a
                                    href="$applink/collective/services/expenses/edit.html?id=$hit.id&searchtype=collectiveexpense&collectionid=$!collectionid"
                                    class="btn btn-xs btn-secondary emdialog"
                                    ><i class="fa fa-edit"></i></a>
                            #end
                        </td>
                    </tr>
                #end
            </table>
        </div>
    #end
</div>

