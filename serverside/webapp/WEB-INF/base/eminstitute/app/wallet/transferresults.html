<Div id="expensereport">

                  <div class="emdata">
                      <table class="table table-striped">
                          <thead>
                              <tr class="tableheader">
                                  #if($showcollections )
                                  <th>[[Collection]]</th>
                                  #end
                                  <th>[[Date]]</th>
                                  <th>[[Topic]]</th>
                                  <th>[[Type]]</th>
                                  <th>[[Destination]]</th>
                                  <th>[[Label]]</th>
                                  <th>[[Total]]</th>
                                  <th></th>
                              </tr>
                          </thead>
                          #set($totalarray = {})
                          #foreach($hit in $transfers)
                               	#if(!$totalarray.get($hit.currencytype))
			                 		#set($totalarray[$hit.currencytype] = [])
			                 	#end
			                 	#set($dumb = $totalarray[$hit.currencytype].add($hit.total))
                              <tr>
                                  #if($showcollections )
                                  <td>
									<a
	                                    href="$applink/collective/services/expenses/index.html?collectionid=$hit.collectionid"
	                                    class="btn btn-xs btn-secondary"
	                                    target="_new"
	                                    data-hidefooter="true"
	                                    >
		                                  $!mediaarchive.getCachedData("librarycollection", $hit.collectionid)
		                             </a>
                                  </td>
                                  #end
                                  <td>$!context.getDate($hit.date)</td>
                                  <td>$!mediaarchive.getCachedData("collectiveproject", $hit.collectiveproject)</td>
                                  <td>$!mediaarchive.getCachedData("expensetype", $hit.expensetype)</td>
                                  <td>
								  #set( $type = false)
                                  #set( $type = $hit.paymententitydesttype)
                                  $pages.include("$apphome/components/xml/typesreadonly/paymententitytype.html?val=$type&targetid=$hit.paymententitydest")
                                  </td>
			                      
                                  <td>#esc($hit.name)</td>
                                  <td style="text-align: right; width:140px;">$!context.doubleToMoney($!hit.total, 2) $!mediaarchive.getCachedData("currencytype", $hit.currencytype)</td>
			                      <td style="text-align: center">
			                            #if( $caneditcollection || $showcollections)
			                                <a
			                                    href="$applink/collective/services/transfers/edit.html?id=$hit.id&searchtype=currencytransaction&collectionid=$hit.collectionid&librarycol=$hit.collectionid"
			                                    class="btn btn-xs btn-secondary emdialog"
			                                    data-hidefooter="true"
			                                    title="[[Edit Transaction]]  $!mediaarchive.getCachedData("librarycollection", $hit.collectionid)"
			                                    ><i class="fa fa-edit"></i></a>
			                                    
			                            #end
			                      </td>
                    </tr>
                #end
                #if($totalarray.size())
                	#set($firstrow = true)
                	#foreach( $total_ in $totalarray.keySet())
						#set($total = $totalarray.get($total_))
						
	                	<tr class="table-totals #if($firstrow)table-totalfirst #set($firstrow=false) #end">
	                		<td colspan="3"></td>
	                		<td class="text-right">[[Total]]:</td>
	                		<td class="text-right">
	                			#set($totaltotal = 0)
	                			#foreach($t in $total)
		                			#if($t)
		                				#set($totaltotal = $mathutil.addition($totaltotal, $t))
		                			#end
	                			#end
	                			$!context.doubleToMoney($totaltotal, 2) $!mediaarchive.getCachedData("currencytype", $total_)
	                			 
	                		</td>
	                		<td></td>
	                		<td></td>
	                	</tr>
	                	
                	#end
                #end
            </table>
            $transfers.size() [[hits]]
        </div>
        <a href="$applink/collective/services/transfers/export/expenses.csv?collectionid=$!{librarycol.id}&hitssessionid=$transfers.getSessionId()"
           class="btn btn-sm btn-primary mb-4">[[Download]]</a>
        
</div>