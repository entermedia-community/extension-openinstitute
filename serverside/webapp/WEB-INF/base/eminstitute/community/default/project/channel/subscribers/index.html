#set($collectionid = $librarycol.getId())
#ifnotnull($collectionid)
<div class="team-list"  id="subscriberssidebar">
	<div class="d-flex align-items-center justify-content-between sidebar-list-header">
		<h3>[[Team Circle]]</h3> 
		#if($user)
			<a class="btn btn-xs emdialog" data-cancelsubmit="true"
				title="[[View Members]]"
				href="$communityhome/project/channel/subscribers/teamlist.html?collectionid=$librarycol.getId()">
				<i class="fas fa-list"></i>
			</a>
		#end
	</div> 
	
	#set($collectionid = $librarycol.getId())
	<div>
		#set( $team = $mediaarchive.query("librarycollectionusers").exact("collectionid",$collectionid).exact("ontheteam",true).search($context) )
		
		#if( $team.isEmpty()) 
			<p class="text-muted text-center">[[No team yet]]</p>
		#else
		<div class="d-flex flex-column">
			#foreach( $hit in $team)
				#set( $followeruser = $mediaarchive.getUser($hit.followeruser) )
				#if($followeruser)
					#set( $userlink = "$!communityhome/users/index.html?id=${followeruser.getId()}")
					#set( $userimageurl = $mediaarchive.asLinkToUserProfile($followeruser) )
					
					#if(!$userimageurl)
						#set( $userimageurl = "$!communityhome/theme/images/user.svg" )
					#end 
					<div class="d-flex flex-row teammember pretty-list">
						<a href="#esc($userlink)" class="d-flex align-items-center flex-grow-1">
							<img  src="${userimageurl}" title="$!followeruser.getAnonNickName()" width="30px" height="30px" class="me-2">
							<span title="$!followeruser.getAnonNickName()  ($!followeruser.getEmail())" style="font-weight: bold;">$!followeruser.getAnonNickName()</span>

							#set($roles=$hit.getValues("teamroles"))

							#ifnotnull($roles)
								<div class="teammemberrole"> 
									#foreach($urole in $roles)
										#set( $role = $mediaarchive.getCachedData("collectiverole",$urole) )
										
										<div class="pl-2" style="display:block;">${role}</div>
									#end 
								</div>
							#end
						</a>
						#if($canviewsettings)
							<a class="btn btn-xs emdialog"
								href="$communityhome/project/channel/subscribers/edit/edit.html?collectionid=$librarycol.getId()&id=$!hit.getId()"
								title="[[Edit Entry]]">
								<i class="fas fa-pen"></i>
							</a>
						#end
					</div>
				#end
			#end
		</div>
		#end 
		<br>
		
		#if( $caneditcollection)
		<div class="d-flex align-items-center justify-content-between w-100 flex-wrap mt-2">
			<a href="${communityhome}/project/channel/subscribers/usersearch.html?collectionid=${collectionid}"
				class="emdialog btn btn-xs me-1" title="[[Search Users]]">
				<i class="fas fa-search me-1"></i> [[Add to Team]]
			</a>
			<a href="${communityhome}/project/channel/subscribers/addnew.html?collectionid=${collectionid}"
				class="emdialog btn btn-xs" title="[[Add New User to Project]]">
				<i class="fas fa-plus me-1"></i> [[New User]]
			</a>
		</div>
		#end
	</div>
</div>
 #end
 